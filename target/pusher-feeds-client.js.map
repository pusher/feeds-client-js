{"version":3,"file":"pusher-feeds-client.js","sources":["../node_modules/pusher-platform-js/target/pusher-platform.js","../src/constants.js","../src/utils.js","../src/feed.js","../src/token-provider.js","../src/feeds.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PusherPlatform\"] = factory();\n\telse\n\t\troot[\"PusherPlatform\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 5);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar subscription_1 = __webpack_require__(1);\nvar resumable_subscription_1 = __webpack_require__(2);\nfunction responseHeadersObj(headerStr) {\n    var headers = {};\n    if (!headerStr) {\n        return headers;\n    }\n    var headerPairs = headerStr.split('\\u000d\\u000a');\n    for (var i = 0; i < headerPairs.length; i++) {\n        var headerPair = headerPairs[i];\n        var index = headerPair.indexOf('\\u003a\\u0020');\n        if (index > 0) {\n            var key = headerPair.substring(0, index);\n            var val = headerPair.substring(index + 2);\n            headers[key] = val;\n        }\n    }\n    return headers;\n}\nexports.responseHeadersObj = responseHeadersObj;\nvar ErrorResponse = (function (_super) {\n    __extends(ErrorResponse, _super);\n    function ErrorResponse(statusCode, headers, info) {\n        var _this = _super.call(this, \"ErroResponse: \" + statusCode + \": \" + info + \" \\n Headers: \" + JSON.stringify(headers)) || this;\n        _this.statusCode = statusCode;\n        _this.headers = headers;\n        _this.info = info;\n        return _this;\n    }\n    ErrorResponse.fromXHR = function (xhr) {\n        return new ErrorResponse(xhr.status, responseHeadersObj(xhr.getAllResponseHeaders()), xhr.responseText);\n    };\n    return ErrorResponse;\n}(Error));\nexports.ErrorResponse = ErrorResponse;\nvar NetworkError = (function (_super) {\n    __extends(NetworkError, _super);\n    function NetworkError(error) {\n        var _this = _super.call(this) || this;\n        _this.error = error;\n        return _this;\n    }\n    return NetworkError;\n}(Error));\nexports.NetworkError = NetworkError;\n// Follows https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/readyState\nvar XhrReadyState;\n(function (XhrReadyState) {\n    XhrReadyState[XhrReadyState[\"UNSENT\"] = 0] = \"UNSENT\";\n    XhrReadyState[XhrReadyState[\"OPENED\"] = 1] = \"OPENED\";\n    XhrReadyState[XhrReadyState[\"HEADERS_RECEIVED\"] = 2] = \"HEADERS_RECEIVED\";\n    XhrReadyState[XhrReadyState[\"LOADING\"] = 3] = \"LOADING\";\n    XhrReadyState[XhrReadyState[\"DONE\"] = 4] = \"DONE\";\n})(XhrReadyState = exports.XhrReadyState || (exports.XhrReadyState = {}));\nvar BaseClient = (function () {\n    function BaseClient(options) {\n        this.options = options;\n        var cluster = options.cluster.replace(/\\/$/, '');\n        this.baseURL = (options.encrypted !== false ? \"https\" : \"http\") + \"://\" + cluster;\n        this.XMLHttpRequest = options.XMLHttpRequest || window.XMLHttpRequest;\n    }\n    BaseClient.prototype.request = function (options) {\n        var xhr = this.createXHR(this.baseURL, options);\n        return new Promise(function (resolve, reject) {\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4) {\n                    if (xhr.status === 200) {\n                        resolve(xhr.responseText);\n                    }\n                    else {\n                        reject(ErrorResponse.fromXHR(xhr));\n                    }\n                }\n            };\n            xhr.send(JSON.stringify(options.body));\n        });\n    };\n    BaseClient.prototype.newSubscription = function (subOptions) {\n        return new subscription_1.Subscription(this.createXHR(this.baseURL, {\n            method: \"SUBSCRIBE\",\n            path: subOptions.path,\n            headers: {},\n            body: null,\n        }), subOptions);\n    };\n    BaseClient.prototype.newResumableSubscription = function (subOptions) {\n        var _this = this;\n        return new resumable_subscription_1.ResumableSubscription(function () {\n            return _this.createXHR(_this.baseURL, {\n                method: \"SUBSCRIBE\",\n                path: subOptions.path,\n                headers: {},\n                body: null,\n            });\n        }, subOptions);\n    };\n    BaseClient.prototype.createXHR = function (baseURL, options) {\n        var XMLHttpRequest = this.XMLHttpRequest;\n        var xhr = new XMLHttpRequest();\n        var path = options.path.replace(/^\\/+/, \"\");\n        var endpoint = baseURL + \"/\" + path;\n        xhr.open(options.method.toUpperCase(), endpoint, true);\n        if (options.body) {\n            xhr.setRequestHeader(\"content-type\", \"application/json\");\n        }\n        if (options.jwt) {\n            xhr.setRequestHeader(\"authorization\", \"Bearer \" + options.jwt);\n        }\n        for (var key in options.headers) {\n            xhr.setRequestHeader(key, options.headers[key]);\n        }\n        return xhr;\n    };\n    return BaseClient;\n}());\nexports.BaseClient = BaseClient;\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(0);\nvar SubscriptionState;\n(function (SubscriptionState) {\n    SubscriptionState[SubscriptionState[\"UNOPENED\"] = 0] = \"UNOPENED\";\n    SubscriptionState[SubscriptionState[\"OPENING\"] = 1] = \"OPENING\";\n    SubscriptionState[SubscriptionState[\"OPEN\"] = 2] = \"OPEN\";\n    SubscriptionState[SubscriptionState[\"ENDING\"] = 3] = \"ENDING\";\n    SubscriptionState[SubscriptionState[\"ENDED\"] = 4] = \"ENDED\"; // called onEnd() or onError(err)\n})(SubscriptionState = exports.SubscriptionState || (exports.SubscriptionState = {}));\n// Asserts that the subscription state is one of the specified values,\n// otherwise logs the current value.\nfunction assertState(stateEnum, states) {\n    var _this = this;\n    if (states === void 0) { states = []; }\n    var check = states.some(function (state) { return stateEnum[state] === _this.state; });\n    var expected = states.join(', ');\n    var actual = stateEnum[this.state];\n    console.assert(check, \"Expected this.state to be \" + expected + \" but it is \" + actual);\n    if (!check) {\n        console.trace();\n    }\n}\nexports.assertState = assertState;\n;\n// Callback pattern: (onOpen onEvent* (onEnd|onError)) | onError\n// A call to `unsubscribe()` will call `options.onEnd()`;\n// a call to `unsubscribe(someError)` will call `options.onError(someError)`.\nvar Subscription = (function () {\n    function Subscription(xhr, options) {\n        var _this = this;\n        this.xhr = xhr;\n        this.options = options;\n        this.state = SubscriptionState.UNOPENED;\n        this.gotEOS = false;\n        this.lastNewlineIndex = 0;\n        this.assertState = assertState.bind(this, SubscriptionState);\n        if (options.lastEventId) {\n            this.xhr.setRequestHeader(\"Last-Event-Id\", options.lastEventId);\n        }\n        this.xhr.onreadystatechange = function () {\n            if (_this.xhr.readyState === base_client_1.XhrReadyState.UNSENT ||\n                _this.xhr.readyState === base_client_1.XhrReadyState.OPENED ||\n                _this.xhr.readyState === base_client_1.XhrReadyState.HEADERS_RECEIVED) {\n                // Too early for us to do anything.\n                _this.assertState(['OPENING']);\n            }\n            else if (_this.xhr.readyState === base_client_1.XhrReadyState.LOADING) {\n                // The headers have loaded and we have partial body text.\n                // We can get this one multiple times.\n                _this.assertState(['OPENING', 'OPEN', 'ENDING']);\n                if (_this.xhr.status === 200) {\n                    // We've received a successful response header.\n                    // The partial body text is a partial JSON message stream.\n                    if (_this.state === SubscriptionState.OPENING) {\n                        _this.state = SubscriptionState.OPEN;\n                        if (_this.options.onOpen) {\n                            _this.options.onOpen();\n                        }\n                    }\n                    _this.assertState(['OPEN', 'ENDING']);\n                    var err = _this.onChunk(); // might transition our state from OPEN -> ENDING\n                    _this.assertState(['OPEN', 'ENDING']);\n                    if (err != null) {\n                        _this.state = SubscriptionState.ENDED;\n                        if (err.statusCode != 204) {\n                            if (_this.options.onError) {\n                                _this.options.onError(err);\n                            }\n                        }\n                        // Because we abort()ed, we will get no more calls to our onreadystatechange handler,\n                        // and so we will not call the event handler again.\n                        // Finish with options.onError instead of the options.onEnd.\n                    }\n                    else {\n                        // We consumed some response text, and all's fine. We expect more text.\n                    }\n                }\n                else {\n                    // Error response. Wait until the response completes (state 4) before erroring.\n                    _this.assertState(['OPENING']);\n                }\n            }\n            else if (_this.xhr.readyState === base_client_1.XhrReadyState.DONE) {\n                // This is the last time onreadystatechange is called.\n                if (_this.xhr.status === 200) {\n                    if (_this.state === SubscriptionState.OPENING) {\n                        _this.state = SubscriptionState.OPEN;\n                        if (_this.options.onOpen) {\n                            _this.options.onOpen();\n                        }\n                    }\n                    _this.assertState(['OPEN', 'ENDING']);\n                    var err = _this.onChunk();\n                    if (err !== null && err !== undefined) {\n                        _this.state = SubscriptionState.ENDED;\n                        if (err.statusCode === 204) {\n                            if (_this.options.onEnd) {\n                                _this.options.onEnd();\n                            }\n                        }\n                        else {\n                            if (_this.options.onError) {\n                                _this.options.onError(err);\n                            }\n                        }\n                    }\n                    else if (_this.state <= SubscriptionState.ENDING) {\n                        if (_this.options.onError) {\n                            _this.options.onError(new Error(\"HTTP response ended without receiving EOS message\"));\n                        }\n                    }\n                    else {\n                        // Stream ended normally.\n                        if (_this.options.onEnd) {\n                            _this.options.onEnd();\n                        }\n                    }\n                }\n                else {\n                    // The server responded with a bad status code (finish with onError).\n                    // Finish with an error.\n                    _this.assertState(['OPENING', 'OPEN', 'ENDED']);\n                    if (_this.state === SubscriptionState.ENDED) {\n                        // We aborted the request deliberately, and called onError/onEnd elsewhere.\n                    }\n                    else {\n                        _this.options.onError(base_client_1.ErrorResponse.fromXHR(_this.xhr));\n                    }\n                }\n            }\n        };\n    }\n    Subscription.prototype.open = function (jwt) {\n        if (this.state !== SubscriptionState.UNOPENED) {\n            throw new Error(\"Called .open() on Subscription object in unexpected state: \" + this.state);\n        }\n        this.state = SubscriptionState.OPENING;\n        if (jwt) {\n            this.xhr.setRequestHeader(\"authorization\", \"Bearer \" + jwt);\n        }\n        this.xhr.send();\n    };\n    // calls options.onEvent 0+ times, then possibly returns an error.\n    // idempotent.\n    Subscription.prototype.onChunk = function () {\n        this.assertState(['OPEN']);\n        var response = this.xhr.responseText;\n        var newlineIndex = response.lastIndexOf(\"\\n\");\n        if (newlineIndex > this.lastNewlineIndex) {\n            var rawEvents = response.slice(this.lastNewlineIndex, newlineIndex).split(\"\\n\");\n            this.lastNewlineIndex = newlineIndex;\n            for (var _i = 0, rawEvents_1 = rawEvents; _i < rawEvents_1.length; _i++) {\n                var rawEvent = rawEvents_1[_i];\n                if (rawEvent.length === 0) {\n                    continue; // FIXME why? This should be a protocol error\n                }\n                var data = JSON.parse(rawEvent);\n                var err = this.onMessage(data);\n                if (err != null) {\n                    return err;\n                }\n            }\n        }\n    };\n    // calls options.onEvent 0+ times, then returns an Error or null\n    Subscription.prototype.onMessage = function (message) {\n        this.assertState(['OPEN']);\n        if (this.gotEOS) {\n            return new Error(\"Got another message after EOS message\");\n        }\n        if (!Array.isArray(message)) {\n            return new Error(\"Message is not an array\");\n        }\n        if (message.length < 1) {\n            return new Error(\"Message is empty array\");\n        }\n        switch (message[0]) {\n            case 0:\n                return null;\n            case 1:\n                return this.onEventMessage(message);\n            case 255:\n                return this.onEOSMessage(message);\n            default:\n                return new Error(\"Unknown Message: \" + JSON.stringify(message));\n        }\n    };\n    // EITHER calls options.onEvent, OR returns an error\n    Subscription.prototype.onEventMessage = function (eventMessage) {\n        this.assertState(['OPEN']);\n        if (eventMessage.length !== 4) {\n            return new Error(\"Event message has \" + eventMessage.length + \" elements (expected 4)\");\n        }\n        var _ = eventMessage[0], id = eventMessage[1], headers = eventMessage[2], body = eventMessage[3];\n        if (typeof id !== \"string\") {\n            return new Error(\"Invalid event ID in message: \" + JSON.stringify(eventMessage));\n        }\n        if (typeof headers !== \"object\" || Array.isArray(headers)) {\n            return new Error(\"Invalid event headers in message: \" + JSON.stringify(eventMessage));\n        }\n        if (this.options.onEvent) {\n            this.options.onEvent({ eventId: id, headers: headers, body: body });\n        }\n    };\n    // calls options.onEvent 0+ times, then possibly returns an error\n    Subscription.prototype.onEOSMessage = function (eosMessage) {\n        this.assertState(['OPEN']);\n        if (eosMessage.length !== 4) {\n            return new Error(\"EOS message has \" + eosMessage.length + \" elements (expected 4)\");\n        }\n        var _ = eosMessage[0], statusCode = eosMessage[1], headers = eosMessage[2], info = eosMessage[3];\n        if (typeof statusCode !== \"number\") {\n            return new Error(\"Invalid EOS Status Code\");\n        }\n        if (typeof headers !== \"object\" || Array.isArray(headers)) {\n            return new Error(\"Invalid EOS Headers\");\n        }\n        this.state = SubscriptionState.ENDING;\n        return new base_client_1.ErrorResponse(statusCode, headers, info);\n    };\n    Subscription.prototype.unsubscribe = function (err) {\n        this.state = SubscriptionState.ENDED;\n        this.xhr.abort();\n        if (err) {\n            if (this.options.onError) {\n                this.options.onError(err);\n            }\n        }\n        else {\n            if (this.options.onEnd) {\n                this.options.onEnd();\n            }\n        }\n    };\n    return Subscription;\n}());\nexports.Subscription = Subscription;\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar subscription_1 = __webpack_require__(1);\nvar retry_strategy_1 = __webpack_require__(6);\nvar ResumableSubscriptionState;\n(function (ResumableSubscriptionState) {\n    ResumableSubscriptionState[ResumableSubscriptionState[\"UNOPENED\"] = 0] = \"UNOPENED\";\n    ResumableSubscriptionState[ResumableSubscriptionState[\"OPENING\"] = 1] = \"OPENING\";\n    ResumableSubscriptionState[ResumableSubscriptionState[\"OPEN\"] = 2] = \"OPEN\";\n    ResumableSubscriptionState[ResumableSubscriptionState[\"ENDING\"] = 3] = \"ENDING\";\n    ResumableSubscriptionState[ResumableSubscriptionState[\"ENDED\"] = 4] = \"ENDED\"; // called onEnd() or onError(err)\n})(ResumableSubscriptionState = exports.ResumableSubscriptionState || (exports.ResumableSubscriptionState = {}));\n// Asserts that the subscription state is one of the specified values,\n// otherwise logs the current value.\nfunction assertState(stateEnum, states) {\n    var _this = this;\n    if (states === void 0) { states = []; }\n    var check = states.some(function (state) { return stateEnum[state] === _this.state; });\n    var expected = states.join(', ');\n    var actual = stateEnum[this.state];\n    console.assert(check, \"Expected this.state to be \" + expected + \" but it is \" + actual);\n    if (!check) {\n        console.trace();\n    }\n}\nexports.assertState = assertState;\n;\n// pattern of callbacks: ((onOpening (onOpen onEvent*)?)? (onError|onEnd)) | onError\nvar ResumableSubscription = (function () {\n    function ResumableSubscription(xhrSource, options) {\n        this.xhrSource = xhrSource;\n        this.options = options;\n        this.state = ResumableSubscriptionState.UNOPENED;\n        this.retryStrategy = new retry_strategy_1.ExponentialBackoffRetryStrategy({});\n        this.assertState = assertState.bind(this, ResumableSubscriptionState);\n        this.lastEventIdReceived = options.lastEventId;\n        this.logger = options.logger;\n    }\n    ResumableSubscription.prototype.tryNow = function () {\n        var _this = this;\n        this.state = ResumableSubscriptionState.OPENING;\n        var newXhr = this.xhrSource();\n        this.subscription = new subscription_1.Subscription(newXhr, {\n            path: this.options.path,\n            lastEventId: this.lastEventIdReceived,\n            onOpen: function () {\n                _this.assertState(['OPENING']);\n                _this.state = ResumableSubscriptionState.OPEN;\n                if (_this.options.onOpen) {\n                    _this.options.onOpen();\n                }\n            },\n            onEvent: function (event) {\n                _this.assertState(['OPEN']);\n                if (_this.options.onEvent) {\n                    _this.options.onEvent(event);\n                }\n                console.assert(!_this.lastEventIdReceived ||\n                    parseInt(event.eventId) > parseInt(_this.lastEventIdReceived), 'Expected the current event id to be larger than the previous one');\n                _this.lastEventIdReceived = event.eventId;\n            },\n            onEnd: function () {\n                _this.state = ResumableSubscriptionState.ENDED;\n                if (_this.options.onEnd) {\n                    _this.options.onEnd();\n                }\n            },\n            onError: function (error) {\n                _this.state = ResumableSubscriptionState.OPENING;\n                _this.retryStrategy.attemptRetry(error)\n                    .then(function () { _this.tryNow; })\n                    .catch(function (error) {\n                    _this.state = ResumableSubscriptionState.ENDED;\n                    if (_this.options.onError) {\n                        _this.options.onError(error);\n                    }\n                });\n            },\n            logger: this.logger\n        });\n        if (this.options.tokenProvider) {\n            this.options.tokenProvider.fetchToken().then(function (jwt) {\n                _this.subscription.open(jwt);\n            }).catch(function (err) {\n                if (_this.options.onError)\n                    _this.options.onError(err);\n            });\n        }\n        else {\n            this.subscription.open(null);\n        }\n    };\n    ResumableSubscription.prototype.open = function () {\n        this.tryNow();\n    };\n    ResumableSubscription.prototype.unsubscribe = function () {\n        this.subscription.unsubscribe(); // We'll get onEnd and bubble this up\n    };\n    return ResumableSubscription;\n}());\nexports.ResumableSubscription = ResumableSubscription;\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"VERBOSE\"] = 1] = \"VERBOSE\";\n    LogLevel[LogLevel[\"DEBUG\"] = 2] = \"DEBUG\";\n    LogLevel[LogLevel[\"INFO\"] = 3] = \"INFO\";\n    LogLevel[LogLevel[\"WARNING\"] = 4] = \"WARNING\";\n    LogLevel[LogLevel[\"ERROR\"] = 5] = \"ERROR\";\n})(LogLevel = exports.LogLevel || (exports.LogLevel = {}));\nvar DefaultLogger = (function () {\n    function DefaultLogger(treshold) {\n        if (treshold === void 0) { treshold = 2; }\n        this.treshold = treshold;\n    }\n    DefaultLogger.prototype.log = function (level, message, error) {\n        if (level >= this.treshold) {\n            console.log(message);\n            if (error) {\n                console.log(error);\n            }\n        }\n    };\n    DefaultLogger.prototype.verbose = function (message, error) {\n        this.log(LogLevel.VERBOSE, message, error);\n    };\n    DefaultLogger.prototype.debug = function (message, error) {\n        this.log(LogLevel.DEBUG, message, error);\n    };\n    DefaultLogger.prototype.info = function (message, error) {\n        this.log(LogLevel.INFO, message, error);\n    };\n    DefaultLogger.prototype.warn = function (message, error) {\n        this.log(LogLevel.WARNING, message, error);\n    };\n    DefaultLogger.prototype.error = function (message, error) {\n        this.log(LogLevel.ERROR, message, error);\n    };\n    return DefaultLogger;\n}());\nexports.DefaultLogger = DefaultLogger;\nvar EmptyLogger = (function () {\n    function EmptyLogger() {\n    }\n    EmptyLogger.prototype.verbose = function (message, error) { };\n    ;\n    EmptyLogger.prototype.debug = function (message, error) { };\n    ;\n    EmptyLogger.prototype.info = function (message, error) { };\n    ;\n    EmptyLogger.prototype.warn = function (message, error) { };\n    ;\n    EmptyLogger.prototype.error = function (message, error) { };\n    ;\n    return EmptyLogger;\n}());\nexports.EmptyLogger = EmptyLogger;\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(0);\nvar logger_1 = __webpack_require__(3);\nvar DEFAULT_CLUSTER = \"api-ceres.pusherplatform.io\";\nvar App = (function () {\n    function App(options) {\n        this.serviceId = options.serviceId;\n        this.tokenProvider = options.tokenProvider;\n        this.client = options.client || new base_client_1.BaseClient({\n            cluster: options.cluster ?\n                sanitizeCluster(options.cluster) : DEFAULT_CLUSTER,\n            encrypted: options.encrypted\n        });\n        if (options.logger) {\n            this.logger = options.logger;\n        }\n        else {\n            this.logger = new logger_1.DefaultLogger();\n        }\n    }\n    App.prototype.request = function (options) {\n        var _this = this;\n        options.path = this.absPath(options.path);\n        var tokenProvider = options.tokenProvider || this.tokenProvider;\n        if (!options.jwt && tokenProvider) {\n            return tokenProvider.fetchToken().then(function (jwt) {\n                return _this.client.request(__assign({ jwt: jwt }, options));\n            });\n        }\n        else {\n            return this.client.request(options);\n        }\n    };\n    App.prototype.subscribe = function (options) {\n        options.path = this.absPath(options.path);\n        options.logger = this.logger;\n        var subscription = this.client.newSubscription(options);\n        var tokenProvider = options.tokenProvider || this.tokenProvider;\n        if (options.jwt) {\n            subscription.open(options.jwt);\n        }\n        else if (tokenProvider) {\n            tokenProvider.fetchToken().then(function (jwt) {\n                subscription.open(jwt);\n            }).catch(function (err) {\n                subscription.unsubscribe(err);\n            });\n        }\n        else {\n            subscription.open(null);\n        }\n        return subscription;\n    };\n    App.prototype.resumableSubscribe = function (options) {\n        options.logger = this.logger;\n        options.path = this.absPath(options.path);\n        var tokenProvider = options.tokenProvider || this.tokenProvider;\n        var resumableSubscription = this.client.newResumableSubscription(__assign({ tokenProvider: tokenProvider }, options));\n        resumableSubscription.open();\n        return resumableSubscription;\n    };\n    App.prototype.absPath = function (relativePath) {\n        return (\"/apps/\" + this.serviceId + \"/\" + relativePath).replace(/\\/+/g, \"/\").replace(/\\/+$/, \"\");\n    };\n    return App;\n}());\nexports.default = App;\nfunction sanitizeCluster(cluster) {\n    return cluster\n        .replace(/^[^\\/:]*:\\/\\//, \"\") // remove schema\n        .replace(/\\/$/, \"\"); // remove trailing slash\n}\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar app_1 = __webpack_require__(4);\nexports.App = app_1.default;\nvar base_client_1 = __webpack_require__(0);\nexports.BaseClient = base_client_1.BaseClient;\nvar resumable_subscription_1 = __webpack_require__(2);\nexports.ResumableSubscription = resumable_subscription_1.ResumableSubscription;\nvar subscription_1 = __webpack_require__(1);\nexports.Subscription = subscription_1.Subscription;\nexports.default = {\n    App: app_1.default,\n    BaseClient: base_client_1.BaseClient,\n    ResumableSubscription: resumable_subscription_1.ResumableSubscription,\n    Subscription: subscription_1.Subscription,\n};\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(0);\nvar logger_1 = __webpack_require__(3);\nvar Retry = (function () {\n    function Retry(waitTimeMilis) {\n        this.waitTimeMilis = waitTimeMilis;\n    }\n    return Retry;\n}());\nexports.Retry = Retry;\nvar DoNotRetry = (function () {\n    function DoNotRetry(error) {\n        this.error = error;\n    }\n    return DoNotRetry;\n}());\nexports.DoNotRetry = DoNotRetry;\nvar ExponentialBackoffRetryStrategy = (function () {\n    function ExponentialBackoffRetryStrategy(options) {\n        this.limit = 6;\n        this.retryCount = 0;\n        this.maxBackoffMilis = 30000;\n        this.currentBackoffMilis = 1000;\n        if (options.limit)\n            this.limit = options.limit;\n        if (options.initialBackoffMilis)\n            this.currentBackoffMilis = options.initialBackoffMilis;\n        if (options.maxBackoffMilis)\n            this.maxBackoffMilis = options.maxBackoffMilis;\n        if (options.logger) {\n            this.logger = options.logger;\n        }\n        else {\n            this.logger = new logger_1.DefaultLogger();\n        }\n    }\n    ExponentialBackoffRetryStrategy.prototype.shouldRetry = function (error) {\n        this.logger.debug(this.constructor.name + \":  Error received\", error);\n        if (this.retryCount >= this.limit && this.limit > 0) {\n            this.logger.debug(this.constructor.name + \":  Retry count is over the maximum limit: \" + this.limit);\n            return new DoNotRetry(error);\n        }\n        var retryable = this.isRetryable(error);\n        if (retryable.isRetryable) {\n            if (retryable.backoffMillis) {\n                this.retryCount += 1;\n                return new Retry(retryable.backoffMillis);\n            }\n            else {\n                this.currentBackoffMilis = this.calulateMilisToRetry();\n                this.retryCount += 1;\n                this.logger.debug(this.constructor.name + \": Will attempt to retry in: \" + this.currentBackoffMilis);\n                return new Retry(this.currentBackoffMilis);\n            }\n        }\n        else {\n            this.logger.debug(this.constructor.name + \": Error is not retryable\", error);\n            return new DoNotRetry(error);\n        }\n    };\n    ExponentialBackoffRetryStrategy.prototype.attemptRetry = function (error) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            var shouldRetry = _this.shouldRetry(error);\n            if (shouldRetry instanceof DoNotRetry) {\n                reject(error);\n            }\n            else if (shouldRetry instanceof Retry) {\n                window.setTimeout(resolve, shouldRetry.waitTimeMilis);\n            }\n        });\n    };\n    ExponentialBackoffRetryStrategy.prototype.isRetryable = function (error) {\n        var retryable = {\n            isRetryable: false\n        };\n        //We allow network errors\n        if (error instanceof base_client_1.NetworkError)\n            retryable.isRetryable = true;\n        else if (error instanceof base_client_1.ErrorResponse) {\n            //Only retry after is allowed\n            if (error.headers[\"retry-after\"]) {\n                retryable.isRetryable = true;\n                retryable.backoffMillis = parseInt(error.headers[\"retry-after\"]) * 1000;\n            }\n        }\n        return retryable;\n    };\n    ExponentialBackoffRetryStrategy.prototype.calulateMilisToRetry = function () {\n        if (this.currentBackoffMilis >= this.maxBackoffMilis || this.currentBackoffMilis * 2 >= this.maxBackoffMilis) {\n            return this.maxBackoffMilis;\n        }\n        if (this.retryCount > 0) {\n            return this.currentBackoffMilis * 2;\n        }\n        return this.currentBackoffMilis;\n    };\n    return ExponentialBackoffRetryStrategy;\n}());\nexports.ExponentialBackoffRetryStrategy = ExponentialBackoffRetryStrategy;\n\n\n/***/ })\n/******/ ]);\n});","export const cacheExpiryTolerance = 10 * 60; // 10 minutes (in seconds)\nexport const defaultAuthEndpoint = \"/feeds/tokens\";\nexport const feedIdRegex = /^[a-zA-Z0-9-]+$/;\nexport const instanceRegex = /^v([1-9][0-9]*):([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)$/;\nexport const servicePath = \"services/feeds/v1\";\nexport const tokenProviderTimeout = 30 * 1000; // 30 seconds (in ms)\n","export function parseResponse(promise) {\n  return new Promise((resolve, reject) => {\n    promise.then(response => {\n      try {\n        resolve(JSON.parse(response));\n      } catch (err) {\n        reject(err);\n      }\n    }).catch(reject);\n  });\n}\n\nexport function urlEncode(data) {\n  return Object.keys(data)\n    .filter(key => data[key] !== undefined)\n    .map(key => `${ key }=${ encodeURIComponent(data[key]) }`)\n    .join(\"&\");\n}\n\nexport function queryString(data) {\n  const encodedData = urlEncode(data);\n  return encodedData ? `?${ encodedData }` : \"\";\n}\n\nexport function unixTimeNow() {\n  return Math.floor(Date.now() / 1000);\n}\n","import { servicePath } from \"./constants\";\nimport { parseResponse, queryString } from \"./utils\";\n\nexport default class Feed {\n  constructor({ app, feedId, readTokenProvider }) {\n    this.app = app;\n    this.feedId = feedId;\n    this.readTokenProvider = readTokenProvider;\n  }\n\n  subscribe(options = {}) {\n    if (typeof options.onItem !== \"function\") {\n      throw new TypeError(\"Must provide an `onItem` callback\");\n    }\n    return this.app.resumableSubscribe({\n      ...options,\n      path: this.itemsPath + queryString({\n        tail_size: options.tailSize,\n      }),\n      tokenProvider: this.readTokenProvider,\n      onEvent: options.onItem,\n    });\n  }\n\n  getHistory({ fromId, limit = 50 } = {}) {\n    return parseResponse(this.app.request({\n      method: \"GET\",\n      path: this.itemsPath + queryString({\n        from_id: fromId,\n        limit: limit,\n      }),\n      tokenProvider: this.readTokenProvider,\n    }));\n  }\n\n  get itemsPath() {\n    return `${ servicePath }/feeds/${ this.feedId }/items`;\n  }\n}\n","import {\n  cacheExpiryTolerance,\n  defaultAuthEndpoint,\n  tokenProviderTimeout,\n} from \"./constants\";\n\nimport { urlEncode, unixTimeNow } from \"./utils\";\n\nexport default class TokenProvider {\n  constructor({ authEndpoint, authData }) {\n    this.authEndpoint = authEndpoint || defaultAuthEndpoint;\n    this.authData = authData;\n  }\n\n  fetchToken() {\n    if (this.cacheIsStale) {\n      return this.makeAuthRequest().then(responseBody => {\n        this.cache(responseBody.access_token, responseBody.expires_in);\n        return this.cachedToken;\n      });\n    }\n    return Promise.resolve(this.cachedToken);\n  }\n\n  get cacheIsStale() {\n    return !this.cachedToken || unixTimeNow() > this.cacheValidUntil;\n  }\n\n  cache(token, expiresIn) {\n    this.cachedToken = token;\n    this.cacheValidUntil = unixTimeNow() + expiresIn - cacheExpiryTolerance;\n  }\n\n  makeAuthRequest() {\n    return new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      xhr.open(\"POST\", this.authEndpoint);\n      xhr.timeout = tokenProviderTimeout;\n      xhr.onload = () => {\n        if (xhr.status === 200) {\n          resolve(JSON.parse(xhr.responseText));\n        } else {\n          reject(new Error(`Couldn't fetch token from ${\n            this.authEndpoint\n          }; got ${ xhr.status } ${ xhr.statusText }.`));\n        }\n      };\n      xhr.ontimeout = () => {\n        reject(new Error(`Request timed out while fetching token from ${\n          this.authEndpoint\n        }`));\n      }\n      xhr.setRequestHeader(\"content-type\", \"application/x-www-form-urlencoded\");\n      xhr.send(urlEncode({\n        ...this.authData,\n        grant_type: \"client_credentials\",\n      }));\n    });\n  }\n}\n","import PusherPlatform from \"pusher-platform-js\";\nimport Feed from \"./feed\";\nimport TokenProvider from \"./token-provider\";\nimport { servicePath, feedIdRegex, instanceRegex } from \"./constants\";\nimport { parseResponse, queryString } from \"./utils\";\n\nexport default class Feeds {\n  constructor({ instance, authData = {}, authEndpoint, host } = {}) {\n    this.authData = authData;\n    this.authEndpoint = authEndpoint;\n    if (!instance || !instance.match(instanceRegex)) {\n      throw new TypeError(`Invalid instance: ${ instance }`);\n    }\n    this.listTokenProvider = new TokenProvider({\n      authEndpoint: this.authEndpoint,\n      authData: {\n        ...this.authData,\n        path: \"feeds\",\n        action: \"READ\",\n      }\n    });\n    this.firehoseTokenProvider = new TokenProvider({\n      authEndpoint: this.authEndpoint,\n      authData: {\n        ...this.authData,\n        path: \"firehose/items\",\n        action: \"READ\",\n      }\n    });\n    this.app = new PusherPlatform.App({ instance, host });\n  }\n\n  list({ prefix, limit } = {}) {\n    return parseResponse(this.app.request({\n      method: \"GET\",\n      path: `${ servicePath }/feeds` + queryString({ prefix, limit }),\n      tokenProvider: this.listTokenProvider,\n    }));\n  }\n\n  feed(feedId) {\n    if (!feedId || !feedId.match(feedIdRegex)) {\n      throw new TypeError(`Invalid feedId: ${ feedId }`);\n    }\n    const readTokenProvider = feedId.startsWith(\"private-\") ? new TokenProvider({\n      authEndpoint:  this.authEndpoint,\n      authData: {\n        ...this.authData,\n        path: `feeds/${ feedId }/items`,\n        action: \"READ\",\n      }\n    }) : null;\n    return new Feed({\n      app: this.app,\n      feedId,\n      readTokenProvider,\n    });\n  }\n\n  firehose({ onPublish, onSubscribe, onUnsubscribe, ...options } = {}) {\n    validateFirehoseCallbacks({ onPublish, onSubscribe, onUnsubscribe });\n    const onEvent = event => {\n      if (event.body.event_type === 0 && onPublish) {\n        onPublish(event);\n      } else if (event.body.event_type === 1 && onSubscribe) {\n        onSubscribe(event);\n      } else if (event.body.event_type === 2 && onUnsubscribe) {\n        onUnsubscribe(event);\n      }\n    };\n    return this.app.subscribe({\n      ...options,\n      onEvent,\n      path: `${ servicePath }/firehose/items`,\n      tokenProvider: this.firehoseTokenProvider,\n    });\n  }\n}\n\nfunction validateFirehoseCallbacks(callbacks) {\n  const defined = Object.keys(callbacks)\n    .filter(k => callbacks[k] !== undefined)\n    .map(k => ({ name: k, callback: callbacks[k] }));\n  defined.forEach(({ name, callback }) => {\n    if (typeof callback !== \"function\") {\n      throw new TypeError(`${ name } must be a function, got ${ callback }`);\n    }\n  });\n  if (defined.length === 0) {\n    throw new TypeError(`Must provide at least one of onPublish, onSubscribe, or onUnsubscribe`);\n  }\n}\n"],"names":["webpackUniversalModuleDefinition","root","factory","module","this","modules","installedModules","__webpack_require__","moduleId","exports","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","__extends","extendStatics","setPrototypeOf","__proto__","Array","b","__","constructor","create","subscription_1","resumable_subscription_1","responseHeadersObj","headerStr","headers","headerPairs","split","length","headerPair","index","indexOf","key","substring","val","ErrorResponse","_super","statusCode","info","_this","JSON","stringify","fromXHR","xhr","status","getAllResponseHeaders","responseText","Error","NetworkError","error","XhrReadyState","BaseClient","options","cluster","replace","baseURL","encrypted","XMLHttpRequest","window","request","createXHR","Promise","resolve","reject","onreadystatechange","readyState","send","body","newSubscription","subOptions","Subscription","path","newResumableSubscription","ResumableSubscription","endpoint","open","method","toUpperCase","setRequestHeader","jwt","base_client_1","SubscriptionState","assertState","stateEnum","states","check","some","state","expected","join","actual","assert","trace","UNOPENED","gotEOS","lastNewlineIndex","bind","lastEventId","UNSENT","OPENED","HEADERS_RECEIVED","LOADING","OPENING","OPEN","onOpen","err","onChunk","ENDED","onError","DONE","undefined","onEnd","ENDING","response","newlineIndex","lastIndexOf","rawEvents","slice","_i","rawEvents_1","rawEvent","data","parse","onMessage","message","isArray","onEventMessage","onEOSMessage","eventMessage","_","id","onEvent","eventId","eosMessage","unsubscribe","abort","retry_strategy_1","ResumableSubscriptionState","xhrSource","retryStrategy","ExponentialBackoffRetryStrategy","lastEventIdReceived","logger","tryNow","newXhr","subscription","event","parseInt","attemptRetry","then","catch","tokenProvider","fetchToken","LogLevel","DefaultLogger","treshold","log","level","verbose","VERBOSE","debug","DEBUG","INFO","warn","WARNING","ERROR","EmptyLogger","__assign","assign","t","arguments","logger_1","DEFAULT_CLUSTER","App","serviceId","client","sanitizeCluster","absPath","subscribe","resumableSubscribe","resumableSubscription","relativePath","default","app_1","Retry","waitTimeMilis","DoNotRetry","limit","retryCount","maxBackoffMilis","currentBackoffMilis","initialBackoffMilis","shouldRetry","retryable","isRetryable","backoffMillis","calulateMilisToRetry","setTimeout","cacheExpiryTolerance","defaultAuthEndpoint","feedIdRegex","instanceRegex","servicePath","tokenProviderTimeout","parseResponse","promise","urlEncode","keys","filter","map","encodeURIComponent","queryString","encodedData","unixTimeNow","Math","floor","Date","now","Feed","app","feedId","readTokenProvider","onItem","TypeError","itemsPath","tailSize","fromId","TokenProvider","authEndpoint","authData","cacheIsStale","makeAuthRequest","cache","responseBody","access_token","expires_in","cachedToken","token","expiresIn","cacheValidUntil","timeout","onload","statusText","ontimeout","Feeds","instance","host","match","listTokenProvider","firehoseTokenProvider","PusherPlatform","prefix","startsWith","onPublish","onSubscribe","onUnsubscribe","event_type","validateFirehoseCallbacks","callbacks","defined","k","callback","forEach"],"mappings":"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"}